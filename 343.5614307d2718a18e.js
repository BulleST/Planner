"use strict";(self.webpackChunkplanner=self.webpackChunkplanner||[]).push([[343],{6343:(ee,L,s)=>{s.r(L),s.d(L,{UsuariosModule:()=>_});var h=s(6895),m=s(202),I=s(1829),y=s(9155),F=s(662),Y=s(2193),j=s(5861),R=s(801),v=s(9808),l=s(4409),S=s(1685),M=s(9398),f=s(8164),b=s(9876),P=s(8913),g=s(3071),O=s(46),e=s(4650),N=s(453),J=s(8944),E=s(3868);function B(t,n){1&t&&e._UZ(0,"app-empresa-select")}const z=function(){return["cadastrar"]};let x=(()=>{class t{constructor(i,a,r,c){var u=this;this.userService=i,this.empresaService=a,this.table=r,this.accountService=c,this.faUsers=R.FVb,this.Role=l.u,this.columns=f.Sf,this.list=[],this.tableLinks=[],this.account=new S.mR,this.menuTable=!0,this.empresaSelected=new M.oW,this.subscription=[],this.create=(o=this.userService)=>{o.setObject(new f.bo)};var T=this.accountService.account.subscribe(o=>this.account=o??new S.mR),Z=this.userService.list.subscribe(o=>this.list=o),U=this.empresaService.empresa.subscribe(function(){var o=(0,j.Z)(function*(d){u.empresaSelected=d,0!=d.id&&(yield(0,v.n)(u.userService.getList()))});return function(d){return o.apply(this,arguments)}}()),C=this.table.selected.subscribe(o=>{o&&((this.account.perfilAcesso_Id==l.u.Admin||this.account.perfilAcesso_Id==l.u.Master&&o.perfilAcesso_Id!=l.u.Admin)&&(this.tableLinks=[{label:"Editar",routePath:["editar"],paramsFieldName:["id"]},{label:o.ativo?"Desabilitar":"Habilitar",routePath:[o.ativo?"desabilitar":"habilitar"],paramsFieldName:["id"]},{label:"Resetar senha",routePath:["reset-password"],paramsFieldName:["id"]}]),this.tableLinks=this.table.encryptParams(this.tableLinks))});this.subscription.push(T),this.subscription.push(Z),this.subscription.push(U),this.subscription.push(C)}ngOnDestroy(){this.subscription.forEach(i=>i.unsubscribe())}canMenu(){return`(${this.account.perfilAcesso_Id} == ${l.u.Admin}) || (${this.account.perfilAcesso_Id} == ${l.u.Master} && item.perfilAcesso_Id != ${l.u.Admin})`}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(g.i),e.Y36(P.P),e.Y36(O.i),e.Y36(b.B))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-list"]],decls:17,vars:16,consts:[[1,"page"],[1,"page__header"],[1,"title-icon"],[3,"icon"],[1,"mr-auto"],[1,"page__header-title"],[1,"page__header-subtitle"],[1,"ml-auto","mb-0","col-xl-3","col-lg-4","col-md-5","col-sm-5","col-12","px-0"],[4,"ngIf"],[1,"page__body"],[3,"createLink","onCreate","canCreate","list","filterLink","filterTable","paginator","sortTable","menuTable","columns","tableLinks","selectable"]],template:function(i,a){1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"span",2),e._UZ(3,"fa-icon",3),e.qZA(),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6,"Usu\xe1rios"),e.qZA(),e.TgZ(7,"p",6)(8,"small"),e._uU(9,"Usu\xe1rios cadastrados em "),e.TgZ(10,"strong"),e._uU(11),e.qZA()()()(),e.TgZ(12,"div",7),e.YNc(13,B,1,0,"app-empresa-select",8),e.qZA()(),e.TgZ(14,"div",9),e._UZ(15,"app-list-shared",10),e.qZA()(),e._UZ(16,"router-outlet")),2&i&&(e.xp6(3),e.Q6J("icon",a.faUsers),e.xp6(8),e.Oqu(a.empresaSelected.nome),e.xp6(2),e.Q6J("ngIf",a.account&&1==a.account.perfilAcesso_Id),e.xp6(2),e.Q6J("createLink",e.DdM(15,z))("onCreate",a.create)("canCreate",!0)("list",a.list)("filterLink",!1)("filterTable",!0)("paginator",!0)("sortTable",!0)("menuTable",a.canMenu())("columns",a.columns)("tableLinks",a.tableLinks)("selectable",!0))},dependencies:[h.O5,m.lC,N.o,J.l,E.BN]}),t})();var Q=s(9243),A=s(7185),G=s(7549);function $(t,n){1&t&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja resetar sua senha?"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"Ao resetar sua senha, voc\xea ser\xe1 automaticamente deslogado para realizar novo login."),e.qZA(),e.TgZ(5,"p",12)(6,"small"),e._uU(7,"Voc\xea receber\xe1 um email informando dessa altera\xe7\xe3o."),e.qZA()()())}function D(t,n){1&t&&(e.TgZ(0,"div",12)(1,"p"),e._uU(2,"Tem certeza que deseja resetar a senha desse usu\xe1rio? "),e.qZA(),e.TgZ(3,"p")(4,"small"),e._uU(5,"Esse usu\xe1rio receber\xe1 um email o informando dessa altera\xe7\xe3o."),e.qZA()()())}function V(t,n){1&t&&e._UZ(0,"span",13)}let H=(()=>{class t{constructor(i,a,r,c,u,T,Z){this.activatedRoute=i,this.toastr=a,this.modal=r,this.empresaService=c,this.userService=u,this.accountService=T,this.crypto=Z,this.faTimes=R.NBC,this.modalOpen=!1,this.erro=[],this.loading=!1,this.url="",this.objeto=new f.bo,this.subscription=[],this.userLogado=this.accountService.accountValue;var U=this.modal.getOpen().subscribe(o=>this.modalOpen=o);this.subscription.push(U),this.url=this.activatedRoute.snapshot.pathFromRoot.map(o=>o.routeConfig?.path).join("/");var C=this.activatedRoute.params.subscribe(o=>{o.usuario_id?(this.objeto.id=this.crypto.decrypt(o.usuario_id),(0,v.n)(this.userService.get(this.objeto.id)).then(d=>{this.objeto=d,setTimeout(()=>{this.modal.setOpen(!0)},200)}).catch(d=>{this.voltar()})):this.voltar()});this.subscription.push(C)}ngOnDestroy(){this.subscription.forEach(i=>i.unsubscribe())}voltar(){this.modal.voltar()}send(){this.loading=!0,(0,v.n)(this.userService.resetPassword(this.objeto.id)).then(i=>{this.voltar(),this.accountService.logout()}).catch().finally(()=>this.loading=!1)}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(m.gz),e.Y36(A._W),e.Y36(G.Q),e.Y36(P.P),e.Y36(g.i),e.Y36(b.B),e.Y36(Q.w))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-reset-password"]],decls:17,vars:5,consts:[[1,"modal"],[1,"modal__bg",3,"click"],[1,"modal__inner",2,"max-width","600px"],[1,"modal__content"],[1,"modal__header","pb-2"],[1,"text-orange"],[1,"modal__header-close","btn-close",3,"click"],[1,"modal__body","mt-0"],[4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-grey","ml-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return a.voltar()}),e.qZA(),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),e._uU(6,"Resetar senha"),e.qZA(),e.TgZ(7,"a",6),e.NdJ("click",function(){return a.voltar()}),e._UZ(8,"span")(9,"span"),e.qZA()(),e.TgZ(10,"div",7),e.YNc(11,$,8,0,"div",8),e.YNc(12,D,6,0,"div",9),e.TgZ(13,"button",10),e.NdJ("click",function(){return a.send()}),e.YNc(14,V,1,0,"span",11),e.TgZ(15,"span"),e._uU(16," Resetar"),e.qZA()()()()()()),2&i&&(e.ekj("active",a.modalOpen),e.xp6(11),e.Q6J("ngIf",(null==a.userLogado?null:a.userLogado.email)==a.objeto.email),e.xp6(1),e.Q6J("ngIf",(null==a.userLogado?null:a.userLogado.email)!=a.objeto.email),e.xp6(2),e.Q6J("ngIf",a.loading))},dependencies:[h.O5]}),t})();var W=s(9751);let p=(()=>{class t{constructor(i,a,r,c){this.accountService=i,this.userService=a,this.router=r,this.toastr=c}canActivate(i,a){return new W.y(r=>{this.userService.objeto.subscribe(c=>{r.next(this.accountService.accountValue?.perfilAcesso_Id!=l.u.Master||c?.perfilAcesso_Id!=l.u.Admin)})})}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(b.B),e.LFG(g.i),e.LFG(m.F0),e.LFG(A._W))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const X=[{path:"",component:x,children:[{path:"cadastrar",component:I.G,title:"Planner - Cadastrar usu\xe1rio"},{path:"editar/:usuario_id",component:Y.F,title:"Planner - Editar usu\xe1rio",canActivate:[p]},{path:"excluir/:usuario_id",component:F.T,title:"Planner - Excluir usu\xe1rio",canActivate:[p]},{path:"reset-password/:usuario_id",component:H,title:"Planner - Resetar senha",canActivate:[p]},{path:"habilitar/:usuario_id",component:y.T,title:"Planner - Habilitar usu\xe1rio",canActivate:[p]},{path:"desabilitar/:usuario_id",component:y.T,title:"Planner - Desabilitar usu\xe1rio",canActivate:[p]}]}];let w=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(X),m.Bz]}),t})();var K=s(433),k=s(9880),q=s(47);let _=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,w,K.u5,A.Rh,k.m,E.uH,q.U$]}),t})()}}]);