<form #form="ngForm" (ngSubmit)="send(form)" class="needs-validation">
    <div class="form-row">
        <div class="form-group col-sm-12" 
            [class.col-lg-6]="!novaCarteiraSetup" 
            [class.col-md-6]="!novaCarteiraSetup" 
            [class.col-lg-4]="novaCarteiraSetup" 
            [class.col-md-4]="novaCarteiraSetup">
            <label for="carteiraSetup">Carteira Setup: <span class="text-danger">*</span></label>
            <select 
                    class="form-control"
                    id="carteiraSetup"
                    name="carteiraSetup"
                    #carteiraSetup="ngModel"
                    [(ngModel)]="objeto.carteiraSetup"
                    [required]="carteiraSetup.touched == true && !novaCarteiraSetup"
                    (change)="novaCarteira()">
                <option [ngValue]="undefined">Selecione</option>
                <option [ngValue]="{id: 1, nome: 'oi'}">oi</option>
            </select>
            <p>Não encontrou a opção desejada? Clique <label for="carteiraSetup" class="link d-inline" (click)="novaCarteira(true)">aqui</label></p>
        </div>
        <div class="form-group col-lg-6 col-md-6 col-sm-12" [class.d-none]="!novaCarteiraSetup"
                [class.fade-out-left]="!novaCarteiraSetup"  
                [class.fade-in-right]="novaCarteiraSetup" >
            <label for="carteiraSetupNova">Adicionar Carteira Setup: <span class="text-danger">*</span></label>
            <input type="text" 
                class="form-control"
                id="carteiraSetupNova"
                name="carteiraSetupNova"
                #carteiraSetupNova="ngModel"
                [(ngModel)]="objeto.carteiraSetupNova"
                [required]="carteiraSetupNova.touched == true && !novaCarteiraSetup">
        </div>
        <div class="form-group col-sm-12" 
            [class.col-lg-6]="!novaCarteiraSetup" 
            [class.col-md-6]="!novaCarteiraSetup" 
            [class.col-lg-2]="novaCarteiraSetup" 
            [class.col-md-2]="novaCarteiraSetup">
            <label for="percentual">Percentual: <span class="text-danger">*</span></label>
            <input 
                class="form-control"
                id="percentual"
                name="percentual"
                mask="separator"
                thousandSeparator="."
                decimalMarker=","
                suffix="%"
                #percentual="ngModel"
                [(ngModel)]="objeto.percentual"
                required>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-lg-5 col-md-5 col-sm-12">
            <label for="produto">Produto: <span class="text-danger">*</span></label>
            <select 
                    class="form-control"
                    id="produto"
                    name="produto"
                    #produto="ngModel"
                    [(ngModel)]="objeto.produto"
                    required="true">
                <option [ngValue]="undefined">Selecione</option>
                <optgroup *ngIf="empresa && empresa.produto.length > 0">
                    <option [ngValue]="item" *ngFor="let item of empresa.produto">{{ item.descricao }}</option>
                </optgroup>
            </select>
            <div *ngIf="produto.touched && produto.errors">
                <p class="text-danger" *ngIf="produto.errors['required']">Esse campo é obrigatório</p>
            </div>
        </div>
        <div class="form-group col-lg-5 col-md-5 col-sm-12">
            <label for="tributacao">Tributação: <span class="text-danger">*</span></label>
            <select 
                    class="form-control"
                    id="tributacao"
                    name="tributacao"
                    #tributacao="ngModel"
                    [(ngModel)]="objeto.tributacao"
                    required="true">
                <option [ngValue]="undefined">Selecione</option>
                <optgroup *ngIf="objeto.produto && objeto.produto.tributacao">
                    <option [ngValue]="item" *ngFor="let item of objeto.produto.tributacao">{{ item.descricao }}</option>
                </optgroup>
            </select>
            <div *ngIf="produto.touched && produto.errors">
                <p class="text-danger" *ngIf="produto.errors['required']">Esse campo é obrigatório</p>
            </div>
        </div>
        <div class="form-group col-lg-2 col-md-2 col-sm-12" 
            [class.fade-out-left]="!objeto.tributacao"  
            [class.fade-in-right]="objeto.tributacao" >
            <label for="aliquota">Alíquota: <span class="text-danger">*</span></label>
            <input type="text" 
                class="form-control"
                id="aliquota"
                name="aliquota"
                mask="separator"
                thousandSeparator="."
                decimalMarker=","
                suffix="%"
                #aliquota
                [value]="objeto.tributacao != undefined ? objeto.tributacao.aliquota : ''"
                readonly>
        </div>
    </div>
    <div class="d-flex p-0 mt-1">
        <div *ngIf="erro || form.invalid" class="m-0">
            <p class="text-red" *ngFor="let err of erro">{{err}}</p>
            <p *ngIf="form.invalid && erro.length == 0" class="text-red">Preencha todos os campos obrigatórios (*) corretamente para salvar</p>
        </div>
        <button class="btn btn-primary mr-0 ml-auto" [disabled]="form.invalid || loading">
            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span> Salvar </button>
    </div>
</form>
<ng-template #campoObrigatorio>
    <div class="py-3 px-4"> Esse campo é obrigatório </div>
</ng-template>