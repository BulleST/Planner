"use strict";(self.webpackChunkplanner=self.webpackChunkplanner||[]).push([[343],{6343:(q,U,s)=>{s.r(U),s.d(U,{UsuariosModule:()=>k});var h=s(6895),p=s(202),E=s(1829),y=s(9155),I=s(662),M=s(2193),O=s(5861),C=s(801),R=s(9808),l=s(4409),L=s(1685),Y=s(9398),v=s(8164),P=s(9876),S=s(8913),f=s(3071),j=s(46),t=s(4650),N=s(453),J=s(8944),F=s(3868);function x(e,o){1&e&&t._UZ(0,"app-empresa-select")}const B=function(){return["cadastrar"]};let z=(()=>{class e{constructor(a,i,r,u){var d=this;this.userService=a,this.empresaService=i,this.table=r,this.accountService=u,this.faUsers=C.FVb,this.Role=l.u,this.columns=v.Sf,this.list=[],this.tableLinks=[],this.account=new L.mR,this.menuTable=!0,this.empresaSelected=new Y.oW,this.subscription=[],this.create=(n=this.userService)=>{n.setObject(new v.bo)};var g=this.accountService.account.subscribe(n=>this.account=n??new L.mR),A=this.userService.list.subscribe(n=>this.list=n),T=this.empresaService.empresa.subscribe(function(){var n=(0,O.Z)(function*(Z){d.empresaSelected=Z,0!=Z.id&&(yield(0,R.n)(d.userService.getList()))});return function(Z){return n.apply(this,arguments)}}()),c=this.table.selected.subscribe(n=>{n&&((this.account.perfilAcesso_Id==l.u.Admin||this.account.perfilAcesso_Id==l.u.Master&&n.perfilAcesso_Id!=l.u.Admin)&&(this.tableLinks=[{label:"Editar",routePath:["editar"],paramsFieldName:["id"]},{label:n.ativo?"Desabilitar":"Habilitar",routePath:[n.ativo?"desabilitar":"habilitar"],paramsFieldName:["id"]},{label:"Resetar senha",routePath:["reset-password"],paramsFieldName:["id"]}]),this.tableLinks=this.table.encryptParams(this.tableLinks))});this.subscription.push(g),this.subscription.push(A),this.subscription.push(T),this.subscription.push(c)}ngOnDestroy(){this.subscription.forEach(a=>a.unsubscribe())}canMenu(){return`(${this.account.perfilAcesso_Id} == ${l.u.Admin}) || (${this.account.perfilAcesso_Id} == ${l.u.Master} && item.perfilAcesso_Id != ${l.u.Admin})`}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(f.i),t.Y36(S.P),t.Y36(j.i),t.Y36(P.B))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list"]],decls:17,vars:16,consts:[[1,"page"],[1,"page__header"],[1,"title-icon"],[3,"icon"],[1,"mr-auto"],[1,"page__header-title"],[1,"page__header-subtitle"],[1,"ml-auto","mb-0","col-xl-3","col-lg-4","col-md-5","col-sm-5","col-12","px-0"],[4,"ngIf"],[1,"page__body"],[3,"createLink","onCreate","canCreate","list","filterLink","filterTable","paginator","sortTable","menuTable","columns","tableLinks","selectable"]],template:function(a,i){1&a&&(t.TgZ(0,"section",0)(1,"div",1)(2,"span",2),t._UZ(3,"fa-icon",3),t.qZA(),t.TgZ(4,"div",4)(5,"h3",5),t._uU(6,"Usu\xe1rios"),t.qZA(),t.TgZ(7,"p",6)(8,"small"),t._uU(9,"Usu\xe1rios cadastrados em "),t.TgZ(10,"strong"),t._uU(11),t.qZA()()()(),t.TgZ(12,"div",7),t.YNc(13,x,1,0,"app-empresa-select",8),t.qZA()(),t.TgZ(14,"div",9),t._UZ(15,"app-list-shared",10),t.qZA()(),t._UZ(16,"router-outlet")),2&a&&(t.xp6(3),t.Q6J("icon",i.faUsers),t.xp6(8),t.Oqu(i.empresaSelected.nome),t.xp6(2),t.Q6J("ngIf",i.account&&1==i.account.perfilAcesso_Id),t.xp6(2),t.Q6J("createLink",t.DdM(15,B))("onCreate",i.create)("canCreate",!0)("list",i.list)("filterLink",!1)("filterTable",!0)("paginator",!0)("sortTable",!0)("menuTable",i.canMenu())("columns",i.columns)("tableLinks",i.tableLinks)("selectable",!0))},dependencies:[h.O5,p.lC,N.o,J.l,F.BN]}),e})();var G=s(9243),b=s(7185),$=s(7549);function D(e,o){1&e&&t._UZ(0,"span",11)}let Q=(()=>{class e{constructor(a,i,r,u,d,g){this.activatedRoute=a,this.toastr=i,this.modal=r,this.empresaService=u,this.userService=d,this.crypto=g,this.faTimes=C.NBC,this.modalOpen=!1,this.erro=[],this.loading=!1,this.url="",this.objeto=new v.bo,this.subscription=[];var A=this.modal.getOpen().subscribe(c=>this.modalOpen=c);this.subscription.push(A),this.url=this.activatedRoute.snapshot.pathFromRoot.map(c=>c.routeConfig?.path).join("/");var T=this.activatedRoute.params.subscribe(c=>{c.usuario_id?this.objeto.id=this.crypto.decrypt(c.usuario_id):this.voltar()});this.subscription.push(T),setTimeout(()=>{this.modal.setOpen(!0)},200)}ngOnDestroy(){this.subscription.forEach(a=>a.unsubscribe())}voltar(){this.modal.voltar()}send(){this.loading=!0,(0,R.n)(this.userService.resetPassword(this.objeto.id)).then(a=>this.voltar()).catch().finally(()=>this.loading=!1)}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(p.gz),t.Y36(b._W),t.Y36($.Q),t.Y36(S.P),t.Y36(f.i),t.Y36(G.w))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-reset-password"]],decls:19,vars:3,consts:[[1,"modal"],[1,"modal__bg",3,"click"],[1,"modal__inner",2,"max-width","600px"],[1,"modal__content"],[1,"modal__header","pb-2"],[1,"text-orange"],[1,"modal__header-close","btn-close",3,"click"],[1,"modal__body","mt-0"],[1,"text-danger"],[1,"btn","btn-grey","ml-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return i.voltar()}),t.qZA(),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),t._uU(6,"Resetar senha"),t.qZA(),t.TgZ(7,"a",6),t.NdJ("click",function(){return i.voltar()}),t._UZ(8,"span")(9,"span"),t.qZA()(),t.TgZ(10,"div",7)(11,"p"),t._uU(12,"Tem certeza que deseja a senha desse usu\xe1rio? "),t.qZA(),t.TgZ(13,"p",8)(14,"small"),t._uU(15,"Esse usu\xe1rio receber\xe1 um email o informando dessa altera\xe7\xe3o."),t.qZA()(),t.TgZ(16,"button",9),t.NdJ("click",function(){return i.send()}),t.YNc(17,D,1,0,"span",10),t._uU(18," Resetar "),t.qZA()()()()()),2&a&&(t.ekj("active",i.modalOpen),t.xp6(17),t.Q6J("ngIf",i.loading))},dependencies:[h.O5]}),e})();var H=s(9751);let m=(()=>{class e{constructor(a,i,r,u){this.accountService=a,this.userService=i,this.router=r,this.toastr=u}canActivate(a,i){return new H.y(r=>{this.userService.objeto.subscribe(u=>{r.next(this.accountService.accountValue?.perfilAcesso_Id!=l.u.Master||u?.perfilAcesso_Id!=l.u.Admin)})})}}return e.\u0275fac=function(a){return new(a||e)(t.LFG(P.B),t.LFG(f.i),t.LFG(p.F0),t.LFG(b._W))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const V=[{path:"",component:z,children:[{path:"cadastrar",component:E.G,title:"Planner - Cadastrar usu\xe1rio"},{path:"editar/:usuario_id",component:M.F,title:"Planner - Editar usu\xe1rio",canActivate:[m]},{path:"excluir/:usuario_id",component:I.T,title:"Planner - Excluir usu\xe1rio",canActivate:[m]},{path:"reset-password/:usuario_id",component:Q,title:"Planner - Resetar senha",canActivate:[m]},{path:"habilitar/:usuario_id",component:y.T,title:"Planner - Habilitar usu\xe1rio",canActivate:[m]},{path:"desabilitar/:usuario_id",component:y.T,title:"Planner - Desabilitar usu\xe1rio",canActivate:[m]}]}];let W=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.Bz.forChild(V),p.Bz]}),e})();var X=s(433),K=s(9880),w=s(47);let k=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[h.ez,W,X.u5,b.Rh,K.m,F.uH,w.U$]}),e})()}}]);