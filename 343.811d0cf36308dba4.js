"use strict";(self.webpackChunkplanner=self.webpackChunkplanner||[]).push([[343],{6343:(X,g,s)=>{s.r(g),s.d(g,{UsuariosModule:()=>W});var h=s(6895),m=s(8627),L=s(1829),A=s(9155),P=s(662),S=s(2193),T=s(5861),Z=s(801),F=s(9808),c=s(4409),U=s(1685),I=s(9398),v=s(8164),C=s(9876),y=s(8913),f=s(3071),E=s(46),e=s(4650),M=s(453),Y=s(8944),R=s(3868);function O(t,i){1&t&&e._UZ(0,"app-empresa-select")}const x=function(){return["cadastrar"]};let j=(()=>{class t{constructor(n,a,r,u){var d=this;this.userService=n,this.empresaService=a,this.table=r,this.accountService=u,this.faUsers=Z.FVb,this.Role=c.u,this.columns=v.Sf,this.list=[],this.tableLinks=[],this.account=new U.mR,this.menuTable=!0,this.empresaSelected=new I.oW,this.create=(o=this.userService)=>{o.setObject(new v.bo)},this.accountService.account.subscribe(o=>this.account=o??new U.mR),this.userService.list.subscribe(o=>this.list=o),this.empresaService.empresa.subscribe(function(){var o=(0,T.Z)(function*(l){d.empresaSelected=l,0!=l.id&&(yield(0,F.n)(d.userService.getList()))});return function(l){return o.apply(this,arguments)}}()),this.table.selected.subscribe(o=>{o&&((this.account.perfilAcesso_Id==c.u.Admin||this.account.perfilAcesso_Id==c.u.Master&&o.perfilAcesso_Id!=c.u.Admin)&&(this.tableLinks=[{label:"Editar",routePath:["editar"],paramsFieldName:["id"]},{label:o.ativo?"Desabilitar":"Habilitar",routePath:[o.ativo?"desabilitar":"habilitar"],paramsFieldName:["id"]},{label:"Resetar senha",routePath:["reset-password"],paramsFieldName:["id"]}]),this.tableLinks=this.table.encryptParams(this.tableLinks))})}ngOnInit(){}canMenu(){return`(${this.account.perfilAcesso_Id} == ${c.u.Admin}) || (${this.account.perfilAcesso_Id} == ${c.u.Master} && item.perfilAcesso_Id != ${c.u.Admin})`}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.i),e.Y36(y.P),e.Y36(E.i),e.Y36(C.B))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-list"]],decls:17,vars:16,consts:[[1,"page"],[1,"page__header"],[1,"title-icon"],[3,"icon"],[1,"mr-auto"],[1,"page__header-title"],[1,"page__header-subtitle"],[1,"ml-auto","mb-0","col-xl-3","col-lg-4","col-md-5","col-sm-5","col-12","px-0"],[4,"ngIf"],[1,"page__body"],[3,"createLink","onCreate","canCreate","list","filterLink","filterTable","paginator","sortTable","menuTable","columns","tableLinks","selectable"]],template:function(n,a){1&n&&(e.TgZ(0,"section",0)(1,"div",1)(2,"span",2),e._UZ(3,"fa-icon",3),e.qZA(),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6,"Usu\xe1rios"),e.qZA(),e.TgZ(7,"p",6)(8,"small"),e._uU(9,"Usu\xe1rios cadastrados em "),e.TgZ(10,"strong"),e._uU(11),e.qZA()()()(),e.TgZ(12,"div",7),e.YNc(13,O,1,0,"app-empresa-select",8),e.qZA()(),e.TgZ(14,"div",9),e._UZ(15,"app-list-shared",10),e.qZA()(),e._UZ(16,"router-outlet")),2&n&&(e.xp6(3),e.Q6J("icon",a.faUsers),e.xp6(8),e.Oqu(a.empresaSelected.nome),e.xp6(2),e.Q6J("ngIf",a.account&&1==a.account.perfilAcesso_Id),e.xp6(2),e.Q6J("createLink",e.DdM(15,x))("onCreate",a.create)("canCreate",!0)("list",a.list)("filterLink",!1)("filterTable",!0)("paginator",!0)("sortTable",!0)("menuTable",a.canMenu())("columns",a.columns)("tableLinks",a.tableLinks)("selectable",!0))},dependencies:[h.O5,m.lC,M.o,Y.l,R.BN]}),t})();var N=s(9243),b=s(7185),J=s(7549);function B(t,i){1&t&&e._UZ(0,"span",11)}let z=(()=>{class t{constructor(n,a,r,u,d,o){this.activatedRoute=n,this.toastr=a,this.modal=r,this.empresaService=u,this.userService=d,this.crypto=o,this.faTimes=Z.NBC,this.modalOpen=!1,this.erro=[],this.loading=!1,this.url="",this.objeto=new v.bo,this.modal.getOpen().subscribe(l=>{this.modalOpen=l}),this.url=this.activatedRoute.snapshot.pathFromRoot.map(l=>l.routeConfig?.path).join("/"),this.activatedRoute.params.subscribe(l=>{l.usuario_id?this.objeto.id=this.crypto.decrypt(l.usuario_id):this.voltar()})}ngOnInit(){setTimeout(()=>{this.modal.setOpen(!0)},200)}voltar(){this.modal.voltar()}send(){var a,n=this;this.loading=!0,this.userService.resetPassword(this.objeto.id).subscribe({next:(a=(0,T.Z)(function*(r){n.voltar()}),function(u){return a.apply(this,arguments)}),error:a=>{this.loading=!1}})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(m.gz),e.Y36(b._W),e.Y36(J.Q),e.Y36(y.P),e.Y36(f.i),e.Y36(N.w))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-reset-password"]],decls:19,vars:3,consts:[[1,"modal"],[1,"modal__bg",3,"click"],[1,"modal__inner",2,"max-width","600px"],[1,"modal__content"],[1,"modal__header","pb-2"],[1,"text-orange"],[1,"modal__header-close","btn-close",3,"click"],[1,"modal__body","mt-0"],[1,"text-danger"],[1,"btn","btn-grey","ml-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(n,a){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return a.voltar()}),e.qZA(),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),e._uU(6,"Resetar senha"),e.qZA(),e.TgZ(7,"a",6),e.NdJ("click",function(){return a.voltar()}),e._UZ(8,"span")(9,"span"),e.qZA()(),e.TgZ(10,"div",7)(11,"p"),e._uU(12,"Tem certeza que deseja a senha desse usu\xe1rio? "),e.qZA(),e.TgZ(13,"p",8)(14,"small"),e._uU(15,"Esse usu\xe1rio receber\xe1 um email o informando dessa altera\xe7\xe3o."),e.qZA()(),e.TgZ(16,"button",9),e.NdJ("click",function(){return a.send()}),e.YNc(17,B,1,0,"span",10),e._uU(18," Resetar "),e.qZA()()()()()),2&n&&(e.ekj("active",a.modalOpen),e.xp6(17),e.Q6J("ngIf",a.loading))},dependencies:[h.O5]}),t})();var G=s(9751);let p=(()=>{class t{constructor(n,a,r,u){this.accountService=n,this.userService=a,this.router=r,this.toastr=u}canActivate(n,a){return new G.y(r=>{this.userService.objeto.subscribe(u=>{r.next(this.accountService.accountValue?.perfilAcesso_Id!=c.u.Master||u?.perfilAcesso_Id!=c.u.Admin)})})}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(C.B),e.LFG(f.i),e.LFG(m.F0),e.LFG(b._W))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const $=[{path:"",component:j,children:[{path:"cadastrar",component:L.G,title:"Planner - Cadastrar usu\xe1rio"},{path:"editar/:usuario_id",component:S.F,title:"Planner - Editar usu\xe1rio",canActivate:[p]},{path:"excluir/:usuario_id",component:P.T,title:"Planner - Excluir usu\xe1rio",canActivate:[p]},{path:"reset-password/:usuario_id",component:z,title:"Planner - Resetar senha",canActivate:[p]},{path:"habilitar/:usuario_id",component:A.T,title:"Planner - Habilitar usu\xe1rio",canActivate:[p]},{path:"desabilitar/:usuario_id",component:A.T,title:"Planner - Desabilitar usu\xe1rio",canActivate:[p]}]}];let Q=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild($),m.Bz]}),t})();var D=s(433),H=s(9880),V=s(5576);let W=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,Q,D.u5,b.Rh,H.m,R.uH,V.U$]}),t})()}}]);